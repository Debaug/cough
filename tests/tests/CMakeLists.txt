function(cough_test name path)
    # add_executable(${name} ${path} ${CMAKE_SOURCE_DIR}/tests/tests/common.c)
    add_executable(${name} ${path})
    target_include_directories(${name} PRIVATE ${CMAKE_SOURCE_DIR}/lib ${CMAKE_SOURCE_DIR}/tests)
    target_link_libraries(${name} PRIVATE libcough)
    add_test(NAME ${name} COMMAND $<TARGET_FILE:${name}>)
endfunction()

cough_test(test_array_buf collections/array_buf.c)
cough_test(test_string_buf collections/string_buf.c)
cough_test(test_hash_map collections/hash_map.c)

cough_test(test_assembler assembler.c)

# cough_test(test_vm_function_call vm/function_call.c)
# cough_test(test_vm_conditional vm/conditional.c)
# cough_test(test_vm_fibonacci vm/fibonacci.c)
